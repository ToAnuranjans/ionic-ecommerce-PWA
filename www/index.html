<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="UTF-8">
  <title>Ionic App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="format-detection" content="telephone=no">
  <meta name="msapplication-tap-highlight" content="no">

  <link rel="icon" type="image/x-icon" href="assets/icon/favicon.ico">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#4e8ef7">

  <!-- cordova.js required for cordova apps -->
  <script src="cordova.js"></script>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then((subscription) => {
          console.log('service worker registered');
            setTimeout(() => {
              subscription.pushManager.subscribe({userVisibleOnly: true}).then((subscription) => {
                const endpoint = subscription.endpoint;
                const key = subscription.getKey('p256dh');
                console.log(endpoint, key);
                localStorage.setItem('notifications', 'true');
              }).catch(function(e) {
                if (Notification.permission === 'denied') {
                  // The user denied the notification permission which
                  // means we failed to subscribe and the user will need
                  // to manually change the notification permission to
                  // subscribe to push messages
                  console.warn('Permission for Notifications was denied');
                  localStorage.setItem('notifications', 'false');
                } else {
                  // A problem occurred with the subscription; common reasons
                  // include network errors, and lacking gcm_sender_id and/or
                  // gcm_user_visible_only in the manifest.
                  localStorage.setItem('notifications', 'false');
                  console.error('Unable to subscribe to push.', e);
                }
              });
            }, 4000);
        })
        .catch(err => console.log('Error', err));
    }
  </script>

  <link href="build/main.css" rel="stylesheet">

</head>

<body>

  <!-- Ionic's root component and where the app will load -->
  <ion-app></ion-app>

  <!-- The polyfills js is generated during the build process -->
  <script src="build/polyfills.js"></script>

  <!-- The bundle js is generated during the build process -->
  <script src="build/main.js"></script>

</body>

</html>